import requests
import pandas as pd

# Make the API call and store the response as a JSON object
response = requests.get('https://api.example.com/data')
json_data = response.json()

# Convert the JSON data to a Pandas DataFrame
df = pd.DataFrame(json_data)

# Create a Pandas Excel writer object
writer = pd.ExcelWriter('data.xlsx', engine='xlsxwriter')

# Write the DataFrame to the Excel worksheet
df.to_excel(writer, sheet_name='Data', index=False)

# Get the worksheet object
worksheet = writer.sheets['Data']

# Set the format for the table headers
header_format = writer.book.add_format({'bold': True, 'bg_color': '#F2F2F2', 'border': 1})

# Set the format for the table rows
row_format = writer.book.add_format({'border': 1})

# Add a table to the worksheet and apply the formatting
worksheet.add_table(0, 0, df.shape[0], df.shape[1]-1, {'header_row': True, 'style': 'Table Style Light 11'})
worksheet.set_row(0, None, header_format)
for i in range(df.shape[0]):
    worksheet.set_row(i+1, None, row_format)

# Save the Excel workbook
writer.save()
